{-
    least square module

    a series of functions to perform a least square regression on a set of data points
    written by tristan damron, 2019
-}

avg :: [Int] -> Int
slope :: [Int] -> [Int] -> Float
intercept :: Int -> Int -> Float -> Float
diff :: Int -> [Int] -> [Int]

avg l = (sum l) `div` (length l)
slope i j = fromIntegral(sum(zipWith (*) i j)) / fromIntegral(sum(map (^2) i))
intercept i j m = (negate (m * fromIntegral i)) + fromIntegral j
diff m i = map (subtract m) i

main = do
    -- Random x data set
    let x = [20, 25, 36, 54, 58, 59, 88, 94, 95, 113, 125, 143, 153, 154, 160, 172, 203, 212, 217, 227, 228, 233, 241, 243, 248, 251, 259, 277, 282, 288, 290, 309, 322, 323, 327, 333, 339, 345, 347, 359, 376, 382, 388, 401, 409, 416, 418, 419, 436, 439, 443, 463, 480, 488, 490, 502, 511, 528, 542, 558, 572, 578, 582, 588, 589, 591, 617, 635, 649, 657, 673, 675, 690, 703, 718, 719, 734, 735, 777, 791, 802, 826, 830, 840, 841, 857, 858, 874, 880, 881, 888, 889, 896, 907, 912, 921, 926, 936, 944, 945, 956, 970, 971, 1000, 1007, 1010, 1025, 1028, 1052, 1062, 1064, 1065, 1070, 1085, 1105, 1106, 1131, 1137, 1158, 1183, 1185, 1187, 1193, 1194, 1201, 1212, 1236, 1246, 1250, 1252, 1261, 1271, 1290, 1299, 1304, 1305, 1335, 1345, 1360, 1383, 1387, 1399, 1407, 1415, 1420, 1424, 1431, 1448, 1450, 1464, 1471, 1476, 1480, 1483, 1500, 1502, 1522, 1523, 1526, 1530, 1531, 1548, 1584, 1586, 1590, 1597, 1599, 1602, 1606, 1611, 1612, 1627, 1645, 1646, 1677, 1683, 1689, 1710, 1715, 1729, 1737, 1742, 1749, 1750, 1754, 1764, 1778, 1779, 1780, 1786, 1791, 1793, 1814, 1821, 1838, 1854, 1868, 1894, 1924, 1935, 1946, 1952, 1973, 1995, 2002, 2004, 2026, 2045, 2048, 2063, 2092, 2098, 2114, 2125, 2134, 2137, 2150, 2152, 2163, 2164, 2168, 2178, 2180, 2212, 2228, 2229, 2238, 2249, 2251, 2266, 2268, 2275, 2280, 2287, 2305, 2309, 2310, 2315, 2316, 2317, 2358, 2366, 2368, 2388, 2399, 2401, 2405, 2409, 2422, 2435, 2437, 2440, 2441, 2459, 2464, 2471, 2491, 2493, 2500, 2506, 2512, 2518, 2523, 2537, 2548, 2562, 2569, 2606, 2631, 2634, 2641, 2660, 2664, 2678, 2706, 2707, 2710, 2729, 2733, 2736, 2743, 2756, 2767, 2775, 2808, 2856, 2859, 2866, 2895, 2921, 2939, 2957, 2978, 2995, 2996, 3019, 3024, 3026, 3027, 3040, 3054, 3062, 3071, 3073, 3095, 3110, 3122, 3128, 3138, 3152, 3158, 3169, 3190, 3208, 3221, 3238, 3261, 3265, 3276, 3284, 3304, 3316, 3323, 3327, 3337, 3351, 3382, 3389, 3398, 3402, 3405, 3418, 3422, 3424, 3436, 3464, 3477, 3490, 3493, 3494, 3505, 3514, 3519, 3520, 3534, 3540, 3545, 3547, 3550, 3553, 3562, 3563, 3577, 3578, 3606, 3611, 3630, 3636, 3650, 3677, 3687, 3696, 3702, 3704, 3712, 3713, 3722, 3724, 3731, 3737, 3739, 3742, 3754, 3763, 3771, 3785, 3790, 3797, 3799, 3800, 3801, 3812, 3823, 3824, 3844, 3847, 3871, 3873, 3877, 3886, 3901, 3902, 3934, 3951, 3974, 3979, 3999, 4028, 4071, 4076, 4080, 4086, 4093, 4119, 4167, 4174, 4180, 4185, 4194, 4216, 4252, 4256, 4269, 4277, 4279, 4283, 4291, 4325, 4338, 4344, 4353, 4363, 4367, 4370, 4377, 4381, 4382, 4386, 4389, 4401, 4407, 4417, 4423, 4425, 4427, 4453, 4457, 4460, 4469, 4485, 4487, 4498, 4500, 4518, 4523, 4525, 4535, 4540, 4572, 4588, 4600, 4602, 4607, 4613, 4624, 4637, 4658, 4660, 4665, 4674, 4676, 4677, 4689, 4728, 4729, 4745, 4761, 4766, 4774, 4781, 4782, 4809, 4810, 4813, 4822, 4831, 4833, 4841, 4860, 4872, 4914, 4915, 4929, 4982, 4987, 4989, 5003, 5018, 5025, 5028, 5037, 5044, 5045, 5062, 5071, 5089, 5092, 5113, 5132, 5136, 5141, 5143, 5151, 5155, 5162, 5167, 5175, 5177, 5182, 5214, 5229, 5246, 5248, 5250, 5261, 5262, 5276, 5282, 5284, 5288, 5296, 5316, 5326, 5345, 5351, 5354, 5357, 5359, 5364, 5389, 5393, 5439, 5456, 5467, 5477, 5479, 5485, 5494, 5503, 5528, 5534, 5558, 5579, 5580, 5582, 5595, 5612, 5634, 5635, 5652, 5654, 5655, 5661, 5669, 5671, 5672, 5674, 5679, 5701, 5708, 5714, 5723, 5729, 5738, 5754, 5758, 5769, 5793, 5805, 5829, 5835, 5840, 5859, 5871, 5878, 5879, 5883, 5895, 5906, 5909, 5917, 5919, 5925, 5928, 5944, 5947, 5949, 5956, 5958, 5963, 5971, 5987, 6007, 6020, 6030, 6037, 6046, 6048, 6054, 6072, 6075, 6080, 6081, 6084, 6087, 6092, 6099, 6107, 6118, 6131, 6134, 6135, 6137, 6158, 6165, 6171, 6182, 6184, 6203, 6204, 6205, 6207, 6211, 6213, 6236, 6239, 6240, 6244, 6246, 6253, 6266, 6342, 6357, 6361, 6371, 6397, 6401, 6406, 6414, 6416, 6438, 6449, 6458, 6464, 6467, 6473, 6498, 6500, 6508, 6509, 6524, 6528, 6530, 6533, 6535, 6537, 6542, 6546, 6547, 6553, 6558, 6568, 6569, 6575, 6591, 6594, 6596, 6600, 6612, 6618, 6625, 6636, 6649, 6650, 6659, 6662, 6663, 6668, 6674, 6677, 6680, 6694, 6701, 6705, 6708, 6709, 6763, 6767, 6794, 6799, 6807, 6810, 6819, 6822, 6824, 6832, 6859, 6874, 6888, 6895, 6898, 6902, 6904, 6940, 6945, 6948, 6962, 6973, 6993, 7018, 7029, 7039, 7040, 7046, 7073, 7107, 7112, 7122, 7125, 7138, 7150, 7160, 7161, 7164, 7182, 7187, 7197, 7202, 7203, 7208, 7233, 7239, 7243, 7278, 7281, 7285, 7301, 7304, 7312, 7330, 7333, 7342, 7346, 7348, 7350, 7351, 7417, 7422, 7429, 7447, 7454, 7466, 7471, 7482, 7495, 7511, 7518, 7527, 7530, 7546, 7558, 7593, 7595, 7596, 7605, 7623, 7633, 7634, 7662, 7665, 7666, 7667, 7668, 7690, 7695, 7712, 7716, 7738, 7762, 7772, 7774, 7792, 7801, 7806, 7809, 7815, 7820, 7823, 7828, 7832, 7839, 7853, 7862, 7864, 7871, 7872, 7876, 7879, 7884, 7896, 7900, 7901, 7915, 7923, 7946, 7947, 7948, 7950, 7952, 7976, 7980, 8002, 8017, 8021, 8045, 8062, 8080, 8091, 8109, 8119, 8125, 8129, 8146, 8157, 8199, 8210, 8235, 8239, 8241, 8244, 8252, 8263, 8302, 8309, 8313, 8322, 8331, 8336, 8339, 8347, 8352, 8354, 8355, 8362, 8368, 8371, 8378, 8385, 8402, 8411, 8432, 8434, 8445, 8451, 8458, 8459, 8460, 8468, 8473, 8491, 8503, 8506, 8580, 8626, 8628, 8636, 8647, 8648, 8665, 8669, 8700, 8703, 8706, 8707, 8713, 8725, 8730, 8734, 8748, 8750, 8751, 8785, 8788, 8789, 8798, 8808, 8821, 8839, 8843, 8855, 8864, 8880, 8897, 8900, 8902, 8919, 8942, 8947, 8952, 8985, 8999, 9003, 9005, 9031, 9038, 9081, 9087, 9100, 9124, 9127, 9129, 9132, 9140, 9151, 9171, 9172, 9185, 9187, 9197, 9198, 9205, 9207, 9222, 9261, 9262, 9270, 9272, 9284, 9286, 9289, 9292, 9307, 9315, 9338, 9357, 9359, 9377, 9407, 9410, 9414, 9423, 9424, 9429, 9448, 9470, 9480, 9526, 9530, 9532, 9539, 9542, 9557, 9562, 9572, 9580, 9587, 9620, 9625, 9639, 9667, 9673, 9683, 9690, 9702, 9707, 9717, 9724, 9740, 9751, 9753, 9772, 9778, 9779, 9789, 9790, 9798, 9806, 9816, 9817, 9826, 9828, 9829, 9869, 9871, 9873, 9876, 9886, 9899, 9901, 9914, 9918, 9929, 9934, 9946, 9960, 9969, 9971, 9974, 9975, 9993]
    -- Random y data set
    let y = [2, 5, 6, 13, 16, 19, 52, 77, 93, 96, 104, 118, 119, 120, 134, 136, 140, 143, 148, 150, 163, 164, 167, 191, 202, 230, 234, 237, 240, 253, 256, 263, 266, 290, 294, 297, 316, 318, 339, 347, 391, 437, 447, 465, 471, 474, 478, 497, 502, 504, 507, 523, 528, 546, 562, 569, 586, 589, 596, 607, 614, 616, 627, 642, 675, 681, 688, 699, 722, 723, 732, 749, 767, 769, 780, 786, 799, 800, 810, 812, 824, 832, 834, 836, 846, 851, 881, 894, 902, 921, 927, 935, 939, 951, 954, 962, 965, 970, 975, 978, 994, 1016, 1023, 1029, 1034, 1039, 1048, 1066, 1072, 1080, 1087, 1092, 1097, 1115, 1119, 1131, 1140, 1165, 1167, 1172, 1176, 1203, 1210, 1219, 1223, 1226, 1230, 1232, 1240, 1251, 1272, 1283, 1292, 1293, 1309, 1313, 1317, 1346, 1355, 1359, 1369, 1375, 1380, 1395, 1398, 1403, 1405, 1430, 1458, 1463, 1469, 1483, 1488, 1494, 1501, 1503, 1509, 1513, 1516, 1519, 1525, 1529, 1537, 1546, 1561, 1572, 1578, 1593, 1601, 1615, 1625, 1644, 1646, 1653, 1683, 1697, 1725, 1770, 1774, 1779, 1782, 1785, 1788, 1798, 1800, 1802, 1804, 1827, 1843, 1853, 1863, 1869, 1884, 1886, 1898, 1900, 1904, 1907, 1922, 1938, 1944, 1957, 1959, 1966, 1978, 1987, 1991, 2007, 2009, 2016, 2018, 2021, 2026, 2029, 2044, 2048, 2052, 2058, 2062, 2067, 2068, 2077, 2080, 2085, 2086, 2090, 2096, 2103, 2106, 2109, 2129, 2130, 2136, 2159, 2173, 2182, 2186, 2192, 2198, 2200, 2205, 2218, 2237, 2272, 2280, 2288, 2291, 2324, 2341, 2379, 2383, 2387, 2392, 2407, 2426, 2440, 2446, 2460, 2469, 2473, 2474, 2480, 2481, 2490, 2492, 2498, 2501, 2507, 2510, 2522, 2532, 2537, 2542, 2558, 2562, 2585, 2587, 2595, 2602, 2623, 2632, 2650, 2659, 2661, 2663, 2668, 2671, 2683, 2685, 2715, 2729, 2731, 2734, 2745, 2749, 2753, 2757, 2771, 2798, 2804, 2810, 2812, 2827, 2838, 2862, 2868, 2871, 2876, 2878, 2898, 2900, 2905, 2906, 2915, 2922, 2935, 2942, 2948, 2953, 2957, 2970, 2987, 3006, 3008, 3028, 3069, 3099, 3106, 3115, 3130, 3132, 3135, 3156, 3163, 3167, 3182, 3193, 3198, 3209, 3216, 3220, 3234, 3265, 3277, 3279, 3298, 3300, 3303, 3353, 3371, 3390, 3392, 3399, 3416, 3436, 3441, 3442, 3444, 3455, 3469, 3471, 3472, 3473, 3493, 3501, 3505, 3522, 3534, 3542, 3553, 3577, 3579, 3580, 3583, 3599, 3608, 3614, 3618, 3626, 3631, 3651, 3658, 3669, 3674, 3681, 3683, 3696, 3701, 3702, 3703, 3730, 3732, 3736, 3745, 3762, 3765, 3776, 3786, 3787, 3795, 3798, 3803, 3811, 3851, 3855, 3858, 3865, 3866, 3867, 3881, 3882, 3886, 3887, 3899, 3906, 3917, 3937, 3938, 3941, 3952, 3953, 3954, 3957, 3960, 3961, 3962, 3993, 3996, 4010, 4016, 4022, 4027, 4034, 4045, 4047, 4051, 4058, 4067, 4070, 4088, 4112, 4121, 4140, 4141, 4143, 4153, 4156, 4161, 4162, 4164, 4168, 4195, 4206, 4210, 4265, 4277, 4286, 4299, 4309, 4318, 4332, 4347, 4374, 4375, 4377, 4380, 4391, 4402, 4427, 4430, 4434, 4439, 4451, 4454, 4480, 4488, 4498, 4499, 4536, 4540, 4558, 4564, 4567, 4570, 4576, 4588, 4598, 4603, 4614, 4643, 4650, 4665, 4675, 4677, 4682, 4686, 4690, 4697, 4702, 4703, 4718, 4734, 4752, 4777, 4794, 4810, 4811, 4852, 4873, 4885, 4896, 4910, 4918, 4919, 4943, 4966, 4972, 4992, 5013, 5033, 5041, 5046, 5051, 5056, 5067, 5091, 5096, 5098, 5099, 5102, 5122, 5125, 5140, 5142, 5149, 5199, 5208, 5223, 5236, 5237, 5245, 5254, 5256, 5259, 5260, 5267, 5271, 5272, 5283, 5298, 5325, 5328, 5332, 5339, 5340, 5344, 5398, 5399, 5404, 5407, 5409, 5412, 5421, 5423, 5428, 5441, 5446, 5454, 5455, 5464, 5469, 5483, 5487, 5492, 5517, 5571, 5575, 5599, 5610, 5629, 5642, 5646, 5648, 5651, 5663, 5669, 5674, 5675, 5681, 5683, 5718, 5723, 5735, 5749, 5755, 5761, 5797, 5802, 5806, 5815, 5824, 5825, 5834, 5836, 5847, 5851, 5853, 5854, 5858, 5863, 5869, 5875, 5879, 5883, 5884, 5887, 5894, 5902, 5903, 5918, 5931, 5946, 5948, 5949, 5957, 5964, 5978, 5981, 5988, 5994, 6008, 6032, 6051, 6068, 6082, 6103, 6119, 6134, 6140, 6142, 6148, 6153, 6161, 6168, 6176, 6188, 6192, 6212, 6222, 6225, 6229, 6232, 6241, 6260, 6262, 6269, 6281, 6287, 6307, 6327, 6341, 6344, 6346, 6361, 6365, 6376, 6413, 6414, 6418, 6424, 6442, 6445, 6449, 6513, 6527, 6542, 6548, 6555, 6578, 6579, 6584, 6594, 6604, 6611, 6616, 6624, 6635, 6656, 6678, 6702, 6711, 6719, 6722, 6731, 6740, 6759, 6766, 6767, 6768, 6783, 6785, 6787, 6806, 6807, 6815, 6826, 6828, 6839, 6843, 6844, 6871, 6874, 6881, 6903, 6904, 6932, 6936, 6943, 6949, 6953, 6954, 6956, 6970, 6984, 7007, 7011, 7040, 7048, 7064, 7070, 7085, 7096, 7097, 7103, 7128, 7153, 7161, 7163, 7165, 7172, 7182, 7190, 7192, 7203, 7215, 7230, 7238, 7239, 7240, 7245, 7254, 7258, 7260, 7271, 7279, 7288, 7291, 7296, 7298, 7303, 7312, 7325, 7327, 7330, 7332, 7347, 7352, 7379, 7383, 7385, 7401, 7410, 7433, 7434, 7437, 7446, 7452, 7475, 7481, 7490, 7502, 7503, 7521, 7533, 7540, 7555, 7558, 7564, 7567, 7596, 7605, 7611, 7635, 7646, 7727, 7732, 7737, 7741, 7755, 7762, 7770, 7774, 7777, 7781, 7782, 7828, 7836, 7840, 7845, 7847, 7884, 7891, 7897, 7901, 7902, 7905, 7914, 7918, 7919, 7934, 7937, 7941, 7946, 7947, 7951, 7970, 7979, 7980, 7986, 7990, 8011, 8015, 8018, 8049, 8052, 8092, 8108, 8134, 8152, 8156, 8195, 8197, 8214, 8272, 8311, 8315, 8337, 8351, 8367, 8384, 8388, 8418, 8436, 8485, 8526, 8536, 8555, 8559, 8573, 8578, 8593, 8608, 8618, 8645, 8659, 8660, 8696, 8698, 8706, 8719, 8732, 8733, 8744, 8753, 8755, 8772, 8783, 8794, 8829, 8835, 8843, 8867, 8868, 8869, 8871, 8879, 8881, 8890, 8891, 8898, 8913, 8919, 8928, 8948, 8954, 8974, 8977, 8993, 9009, 9025, 9030, 9035, 9058, 9062, 9081, 9096, 9128, 9132, 9138, 9140, 9142, 9157, 9159, 9161, 9174, 9183, 9216, 9240, 9270, 9296, 9302, 9305, 9307, 9339, 9344, 9367, 9368, 9371, 9375, 9393, 9396, 9414, 9423, 9431, 9435, 9437, 9446, 9464, 9465, 9467, 9479, 9494, 9498, 9501, 9509, 9510, 9512, 9513, 9516, 9523, 9524, 9533, 9537, 9549, 9553, 9554, 9556, 9562, 9567, 9584, 9609, 9621, 9624, 9625, 9638, 9650, 9680, 9689, 9692, 9704, 9723, 9726, 9729, 9732, 9735, 9745, 9746, 9749, 9773, 9774, 9782, 9783, 9812, 9834, 9839, 9860, 9865, 9866, 9893, 9896, 9929, 9940, 9942, 9947, 9955, 9956, 9962, 9983, 9992, 9995]
    let mx = avg x
    let my = avg y
    let dx = diff mx x
    let dy = diff my y
    let m = slope dx dy
    let b = intercept mx my m
    print m
    print b
